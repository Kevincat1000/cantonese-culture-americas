<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cantonese Culture in the Americas</title>

  <link href="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.css" rel="stylesheet" />

  <style>
    :root{--bg:#ffffff;--text:#0b0f19;--muted:#4b5563;--line:#e5e7eb;--blue-100:#e6f2ff;--shadow:0 10px 30px rgba(0,0,0,.06);--radius:18px;--max:1220px;--font:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial,"Noto Sans","PingFang SC","Microsoft YaHei",sans-serif;}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:var(--font);background:var(--bg);color:var(--text);line-height:1.5}
    a{color:inherit;text-decoration:none}
    .container{max-width:var(--max);margin:0 auto;padding:0 24px}

    .header{position:sticky;top:0;z-index:1000;background:rgba(255,255,255,.9);backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid var(--line);}
    .nav{height:76px;display:flex;align-items:center;justify-content:space-between;gap:18px}
    .brand{display:flex;align-items:center;gap:12px;min-width:220px}
    .brand img{width:44px;height:44px;border-radius:12px;object-fit:cover}
    .brand .title{font-weight:650;letter-spacing:.2px}
    .nav-right{display:flex;align-items:center;gap:18px}

    .nav-item{position:relative;font-size:14px;font-weight:600;letter-spacing:.2px;padding:10px 10px;border-radius:12px;color:var(--text)}
    .nav-item:hover{background:#f4f6f8}

    .dropdown{position:absolute;top:44px;left:0;width:360px;background:#fff;border:1px solid var(--line);box-shadow:var(--shadow);border-radius:16px;padding:10px;display:none}
    .nav-item::after{content:"";position:absolute;left:0;right:0;top:40px;height:10px;display:none}
    .nav-item:hover::after{display:block}
    .nav-item:hover .dropdown{display:block}
    .dropdown a{display:block;padding:10px 12px;border-radius:12px;font-size:13px;font-weight:600;color:var(--text)}
    .dropdown a span{display:block;margin-top:3px;font-weight:500;color:var(--muted);font-size:12px;line-height:1.25}
    .dropdown a:hover{background:var(--blue-100)}

    .lang{display:flex;align-items:center;gap:8px;border:1px solid var(--line);padding:8px 10px;border-radius:999px;font-size:13px;font-weight:650;cursor:pointer;user-select:none}
    .lang:hover{background:#f4f6f8}
    .lang svg{width:18px;height:18px}

    .hero{padding:72px 0 32px}
    .hero h1{font-size:64px;line-height:1.05;letter-spacing:-.02em;margin:0 0 16px;font-weight:750}
    .hero p.lead{font-size:20px;margin:0 0 22px;color:var(--muted);max-width:820px}
    .hero p.body{font-size:16px;margin:0 0 18px;max-width:900px;color:#111827}
    .cta{display:inline-flex;align-items:center;gap:10px;padding:12px 16px;border:1px solid var(--line);border-radius:14px;font-weight:700;font-size:14px;background:#fff}
    .cta:hover{border-color:#cbd5e1;box-shadow:0 8px 22px rgba(0,0,0,.06)}

    .row{display:grid;grid-template-columns:1.05fr .95fr;gap:28px;align-items:start;padding:34px 0 18px}
    .card{border:1px solid var(--line);border-radius:var(--radius);padding:18px;background:#fff;box-shadow:0 10px 26px rgba(0,0,0,.03)}
    .section-title{font-size:20px;margin:0 0 14px;font-weight:750}
    .phase-grid{display:grid;grid-template-columns:1fr;gap:12px}
    .phase{border:1px solid var(--line);border-radius:16px;padding:14px 14px;font-weight:750;font-size:14px;background:#fff;transition:background .15s,border-color .15s,transform .15s}
    .phase small{display:block;margin-top:6px;font-weight:600;color:var(--muted);font-size:12.5px;line-height:1.25}
    .phase:hover{background:var(--blue-100);border-color:#bfdbfe;transform:translateY(-1px)}

    .map-card{padding:0;overflow:hidden}
    #diaspora-map{width:100%;height:540px}

    .mosaic{padding:26px 0 70px}
    .mosaic h2{margin:0 0 14px;font-size:22px;font-weight:800}
    .mosaic-grid{display:grid;grid-template-columns:1.4fr 1fr;gap:18px}
    .mosaic-left{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .mosaic img{width:100%;height:260px;object-fit:cover;border-radius:24px;border:1px solid var(--line);box-shadow:0 18px 40px rgba(0,0,0,.06);background:#f3f4f6}
    .mosaic-right img{height:538px}

    .footer{border-top:1px solid var(--line);padding:24px 0;color:var(--muted);font-size:13px}

    @media (max-width:980px){
      .row{grid-template-columns:1fr}
      .hero h1{font-size:44px}
      .brand{min-width:auto}
      .dropdown{width:320px}
      .mosaic-grid{grid-template-columns:1fr}
      .mosaic-right img{height:260px}
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="container">
      <nav class="nav" aria-label="Primary">
        <a class="brand" href="index.html" aria-label="Home">
          <img src="assets/logo.jpeg" alt="Logo" />
          <div class="title">Cantonese in Americas</div>
        </a>

        <div class="nav-right">
          <!-- ✅ 新增 Home -->
          <a class="nav-item" href="index.html">Home</a>

          <div class="nav-item" role="button" tabindex="0">
            <span data-i18n="navTimeline">Timeline</span>
            <div class="dropdown" aria-label="Timeline dropdown">
              <a href="phase1.html">Phase I <span>17th–19th Centuries: Early Migration within Southeast Asia</span></a>
              <a href="phase2.html">Phase II <span>17th–19th Centuries: Early Migration within Southeast Asia</span></a>
              <a href="phase3.html">Phase III <span>17th–19th Centuries: Early Migration within Southeast Asia</span></a>
              <a href="phase4.html">Phase IV <span>17th–19th Centuries: Early Migration within Southeast Asia</span></a>
            </div>
          </div>

          <div class="nav-item" role="button" tabindex="0">
            <span data-i18n="navResearch">Research</span>
            <div class="dropdown" aria-label="Research dropdown" style="width:300px">
              <a href="oral.html">Oral History</a>
              <a href="culture.html">Culture Record</a>
              <a href="influence.html">Influence Research</a>
            </div>
          </div>

          <a class="nav-item" href="archives.html"><span data-i18n="navArchives">Archives</span></a>
          <a class="nav-item" href="resources.html"><span data-i18n="navResources">Resources</span></a>

          <div class="lang" id="langBtn" data-current="en" aria-label="Toggle language">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z" stroke="currentColor" stroke-width="1.6"/>
              <path d="M2 12h20" stroke="currentColor" stroke-width="1.6"/>
              <path d="M12 2c2.7 2.6 4.3 6.1 4.3 10S14.7 19.4 12 22c-2.7-2.6-4.3-6.1-4.3-10S9.3 4.6 12 2Z" stroke="currentColor" stroke-width="1.6"/>
            </svg>
            <span class="langLabel">EN</span>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container">
        <h1 data-i18n="h1">Cantonese culture in the Americas</h1>
        <p class="lead" data-i18n="sub">Public History · Oral History · Cultural Research</p>

        <p class="body">
          Since the seventeenth century, hundreds of thousands of Cantonese migrants from Guangdong’s coastal region have crossed the South China Sea and the Pacific through commerce, contract labor, education, and family reunification. They moved back and forth among Hong Kong, Southeast Asia, and North America.
        </p>
        <p class="body">
          This project shifts the focus from a single origin group to a broader question: how Cantonese culture has been carried abroad, transformed, and transmitted across generations. Through oral histories, visual archives, and digital humanities methods, this project documents cultural survival, migration, and memory.
        </p>

        <a class="cta" href="introduction.html"><span data-i18n="introTitle">View the full introduction</span> →</a>

        <div class="row" style="margin-top:26px">
          <div class="card">
            <h2 class="section-title" data-i18n="sectionTimeline">Timeline</h2>
            <div class="phase-grid">
              <a class="phase" href="phase1.html">Phase I <small>17th–19th Centuries: Early Migration within Southeast Asia</small></a>
              <a class="phase" href="phase2.html">Phase II <small>17th–19th Centuries: Early Migration within Southeast Asia</small></a>
              <a class="phase" href="phase3.html">Phase III <small>17th–19th Centuries: Early Migration within Southeast Asia</small></a>
              <a class="phase" href="phase4.html">Phase IV <small>17th–19th Centuries: Early Migration within Southeast Asia</small></a>
            </div>
          </div>

          <div class="card map-card" aria-label="Map">
            <div id="diaspora-map"></div>
          </div>
        </div>
      </div>
    </section>

    <section class="mosaic">
      <div class="container">
        <h2 data-i18n="mosaicTitle">Visual archives (sample layout)</h2>
        <div class="mosaic-grid">
          <div class="mosaic-left">
            <img src="assets/dimsum.jpg" alt="Guangdong dim sum" />
            <img src="assets/guangxiao.jpg" alt="Guangxiao Temple" />
            <img src="assets/sfchinatown.jpg" alt="San Francisco Chinatown" />
            <img src="assets/cantonese_opera.jpg" alt="Cantonese Opera" />
          </div>
          <div class="mosaic-right">
            <img src="assets/sfchinatown.jpg" alt="Feature collage" />
          </div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div class="container">© <span id="year"></span> Cantonese Culture in the Americas · Built for public scholarship.</div>
    </footer>
  </main>

  <script src="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.js"></script>

  <!-- ====== START: Integrated Maritime + Flight Routes ====== -->
  <script>
  mapboxgl.accessToken =
    "pk.eyJ1Ijoia2V2aW5jYXQxMDAiLCJhIjoiY21qbmFyN21yMTYzMzNlcHN5ZHVubTdpbiJ9.m8QPkEMJKLNIMvFyKUgTkw";
  const STYLE_URL = "mapbox://styles/kevincat100/cmjneo20k000v01sxghqb6aqr";
  const C_ROUTE1="#3d85c6",C_ROUTE2="#e69138",C_ROUTE3="#6a329f",C_ROUTE4="#666666",C_ROUTE5="#cc0000";
  const ROUTE_WIDTH=2,DASH_BASE=[2,2],ANIM_MS=260;

  const map=new mapboxgl.Map({container:"diaspora-map",style:STYLE_URL,center:[120,28],zoom:3.6});
  map.addControl(new mapboxgl.NavigationControl(),"top-right");

  map.on("load",()=>{
    const points=[
      { title:"Si Yi", subtitle:"Sze Yup region of Guangdong", country:"China", coords:[112.98, 22.54] },
      { title:"Hong Kong", subtitle:"", country:"China", coords:[114.1694, 22.3193] },
      { title:"Ayutthaya Kingdom", subtitle:"Ayutthaya", country:"Thailand", coords:[100.5689, 14.3532] },
      { title:"Hà Tiên", subtitle:"", country:"Vietnam", coords:[104.4833, 10.3833] },
      { title:"Saigon", subtitle:"Ho Chi Minh City", country:"Vietnam", coords:[106.6297, 10.8231] },
      { title:"Penang", subtitle:"", country:"Malaysia", coords:[100.3354, 5.4141] },
      { title:"Singapore", subtitle:"", country:"Singapore", coords:[103.8198, 1.3521] },
      { title:"San Francisco", subtitle:"", country:"United States", coords:[-122.4194, 37.7749] }
    ];

    points.forEach(p=>{
      const el=document.createElement("div");
      el.style.width="12px";el.style.height="12px";el.style.borderRadius="999px";
      el.style.background="#111";el.style.border="2px solid #fff";el.style.boxShadow="0 1px 6px rgba(0,0,0,.25)";
      const popupHtml=`
        <div style="font-family:system-ui; font-size:13px; line-height:1.25;">
          <div style="font-weight:700;">${escapeHtml(p.title)}</div>
          ${p.subtitle?`<div style="opacity:.8;">${escapeHtml(p.subtitle)}</div>`:``}
          <div style="opacity:.6;">${escapeHtml(p.country)}</div>
        </div>`;
      new mapboxgl.Marker({element:el}).setLngLat(p.coords).setPopup(new mapboxgl.Popup({offset:18}).setHTML(popupHtml)).addTo(map);
    });

    function addRoute(id,coords,color){
      map.addSource(id,{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:coords}}});
      map.addLayer({id:id+"-line",type:"line",source:id,layout:{"line-cap":"round","line-join":"round"},
        paint:{"line-color":color,"line-width":ROUTE_WIDTH,"line-dasharray":DASH_BASE}});
    }

    addRoute("r1",[[112.98,22.54],[114.0,21.8],[113.2,20.0],[112.0,18.2],[111.0,16.2],[110.2,14.5],[109.5,13.2],[109.0,11.8],[108.2,10.5],[106.8,9.2],[105.2,8.8],[103.6,8.9],[102.0,9.2],[101.0,10.2],[100.6,12.0],[100.5689,14.3532]],C_ROUTE1);
    addRoute("r2",[[100.5689,14.3532],[101.0,12.8],[101.6,11.6],[102.4,10.9],[103.3,10.6],[104.0,10.5],[104.4833,10.3833],[104.9,10.0],[105.6,9.6],[106.1,9.8],[106.4,10.2],[106.6297,10.8231]],C_ROUTE2);
    addRoute("r3",[[112.98,22.54],[113.6,20.5],[112.6,18.0],[111.0,15.0],[109.5,12.5],[107.8,10.2],[105.8,8.2],[103.5,6.8],[101.8,6.0],[100.3354,5.4141],[101.6,4.1],[102.7,2.7],[103.3,2.0],[103.8198,1.3521]],C_ROUTE3);
    addRoute("r4",[[106.6297,10.8231],[122.0,18.0],[138.0,26.0],[154.0,33.0],[170.0,38.0],[186.0,40.5],[202.0,41.5],[218.0,40.5],[232.0,39.2],[237.5806,37.7749]],C_ROUTE4);
    addRoute("r5",[[114.1694,22.3193],[130.0,28.0],[146.0,34.0],[162.0,39.0],[176.0,43.0],[190.0,45.0],[206.0,44.5],[222.0,42.5],[233.0,40.5],[237.5806,37.7749]],C_ROUTE5);

    const dashSeq=[[0,4,3],[0.5,4,2.5],[1,4,2],[1.5,4,1.5],[2,4,1],[2.5,4,0.5],[3,4,0]];
    const animatedLayers=["r1-line","r2-line","r3-line","r4-line","r5-line"];
    let step=0;
    setInterval(()=>{const d=dashSeq[step];animatedLayers.forEach(id=>{if(map.getLayer(id)) map.setPaintProperty(id,"line-dasharray",d);});
      step=(step+1)%dashSeq.length;},ANIM_MS);
  });

  function escapeHtml(str){return String(str).replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"}[m]));}
  </script>
  <!-- ====== END: Integrated Maritime + Flight Routes ====== -->

  <script>
    document.getElementById("year").textContent=new Date().getFullYear();
    const I18N={
      en:{navTimeline:"Timeline",navResearch:"Research",navArchives:"Archives",navResources:"Resources",h1:"Cantonese culture in the Americas",sub:"Public History · Oral History · Cultural Research",introTitle:"View the full introduction",sectionTimeline:"Timeline",mosaicTitle:"Visual archives (sample layout)"},
      zh:{navTimeline:"时间线",navResearch:"研究",navArchives:"档案",navResources:"资源",h1:"美洲的粤语文化",sub:"公共史学 · 口述史 · 文化研究",introTitle:"查看完整介绍",sectionTimeline:"时间线",mosaicTitle:"视觉档案（示例布局）"}
    };
    function applyLang(lang){
      document.querySelectorAll("[data-i18n]").forEach(el=>{const k=el.getAttribute("data-i18n");if(I18N[lang]&&I18N[lang][k]) el.textContent=I18N[lang][k];});
      const btn=document.getElementById("langBtn");btn.setAttribute("data-current",lang);btn.querySelector(".langLabel").textContent=(lang==="en"?"EN":"中文");
    }
    document.getElementById("langBtn").addEventListener("click",()=>{const btn=document.getElementById("langBtn");const curr=btn.getAttribute("data-current")||"en";applyLang(curr==="en"?"zh":"en");});
    applyLang("en");
  </script>
</body>
</html>
